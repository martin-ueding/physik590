% Copyright © 2014 Martin Ueding <dev@martin-ueding.de>

\chapter{Implementierung}

% FIXME Dies irgendwie weniger aufdringlich unterbringen.
\begin{small}
    Mein Programm ist freie Software und unter
    \url{http://martin-ueding.de/de/university/physik590/} erhältlich.
\end{small}

Die Weltlinie wird in der Regel anfangs mit zufälligen Werten für die $x_j$ aus
dem Interval $(-\initialrandomwidth, \initialrandomwidth)$ initialisiert. Bevor
Werte aufgenommen werden, durchläuft das System $\preiterations$ Monte Carlo
Iterationen (meist \num{50}) zur Relaxation. Danach sieht die Weltlinie wie in
Abbildung~\ref{fig:relaxiert} aus.

\begin{figure}[htbp]
    \centering
    \tikzsetnextfilename{relaxiert}
    \begin{tikzpicture}
        \begin{axis}[
                width=\linewidth,
                height=0.5\linewidth,
                xlabel={$j = t/a$},
                ylabel={$x_j = x(t/a)$},
            ]
            \addplot[black] table {CSV/11EA8F-trajectory-04-more_iterations.csv};
        \end{axis}
    \end{tikzpicture}
    \caption{%
        Weltlinie nach $\preiterations = \num{50}$ Iterationen zur Relaxation.
        Dabei sind die Parameter $\timestep = \num{0.1}$, $\initialrandomwidth
        = \margin = \num{0.632456}$, und $\mu^2 = \num{1}$.
    }
    \label{fig:relaxiert}
\end{figure}

\section{Harmonischer Oszillator}

\subsection{Aufenthaltswahrscheinlichkeit}

In Abbildung~\ref{fig:histogram_01} ist die Aufenthaltswahrscheinlichkeit für
eine recht feine Zeitauflösung $\timestep$ dargestellt. Die erwartete
Verteilung unterscheidet sich kaum von der Kontinuumslösung. Am Maximum der
Kurve ist noch am ehesten zu erkennen, dass das Kontinuum ein Bruchteil der
Liniendicke unterhalb der Gitterlösung liegt, siehe
Abbildung~\ref{fig:histogram_01_zoom}.

Bei einer geringeren Zeitauflösung $\timestep$ ist eine Normalverteilung mit
geringerer Breite zu erwarten. Für $\timestep = \num{1}$ ist die
Aufenthaltswahrscheinlichkeit in Abbildung~\ref{fig:histogram_10} dargestellt.
Die Datenpunkte aus der Simulation liegen gut auf der erwarteten Kurve. Diese
weicht merklich von der Kontinuumslösung ab.

\begin{figure}[htbp]
    \centering
    \tikzsetnextfilename{histogram_01}
    \begin{tikzpicture}
        \begin{axis}[
                width=\linewidth,
                height=0.55\linewidth,
                xlabel={$x$},
                ylabel={$|\psi(x)|^2$},
                grid=major,
                xmin=-3,
                xmax=3,
                legend entries={
                    {Simulation},
                    {Theorie},
                    Kontinuum,
                },
            ]
            \addplot[
                black,
                only marks,
                mark=|,
                error bars/.cd,
                y dir=both,
                y explicit
            ] table[y error index=2] {CSV/histogram-korrigiert.csv};
            \addplot[black] table {_build/histogram_theory_01.csv};
            \addplot[black, dashed] table {_build/histogram_theory_continous.csv};
        \end{axis}
    \end{tikzpicture}
    \caption{%
        Aufenthaltswahrscheinlichkeit. $\timestep =
        \num{0.1}$, $\Delta = \num{0.632456}$, $\mu^2 = \num{1}$, $\timesites =
        \num{1000}$, $\iterations = \num{1000}$, $\bootstrapsamples = \num{10000}$.
    }
    \label{fig:histogram_01}
\end{figure}

\begin{figure}[htbp]
    \centering
    \tikzsetnextfilename{histogram_01_zoom}
    \begin{tikzpicture}
        \begin{axis}[
                width=\linewidth,
                height=0.55\linewidth,
                xlabel={$x$},
                ylabel={$|\psi(x)|^2$},
                grid=major,
                xmin=-0.3,
                xmax=0.3,
                legend entries={
                    {Simulation},
                    {Theorie},
                    Kontinuum,
                },
            ]
            \addplot[
                black,
                only marks,
                mark=|,
                error bars/.cd,
                y dir=both,
                y explicit
            ] table[y error index=2] {CSV/histogram-korrigiert.csv};
            \addplot[black] table {_build/histogram_theory_01.csv};
            \addplot[black, dashed] table {_build/histogram_theory_continous.csv};
        \end{axis}
    \end{tikzpicture}
    \caption{%
        Ausschnittsvergrößerung der Aufenthaltswahrscheinlichkeit. $\timestep =
        \num{0.1}$, $\Delta = \num{0.632456}$, $\mu^2 = \num{1}$, $\timesites =
        \num{1000}$, $\iterations = \num{1000}$, $\bootstrapsamples = \num{10000}$.
    }
    \label{fig:histogram_01_zoom}
\end{figure}

\begin{figure}[htbp]
    \centering
    \tikzsetnextfilename{histogram_10}
    \begin{tikzpicture}
        \begin{axis}[
                width=\linewidth,
                height=0.55\linewidth,
                xlabel={$x$},
                ylabel={$|\psi(x)|^2$},
                grid=major,
                xmin=-3,
                xmax=3,
                legend entries={
                    {Simulation},
                    {Theorie},
                    Kontinuum,
                },
            ]
            \addplot[
                black,
                only marks,
                mark=|,
                error bars/.cd,
                y dir=both,
                y explicit
            ] table[y error index=2] {CSV/DC5256-histogram-position-resultset.csv};
            \addplot[black] table {_build/histogram_theory_1.csv};
            \addplot[black, dashed] table {_build/histogram_theory_continous.csv};
        \end{axis}
    \end{tikzpicture}
    \caption{%
        Aufenthaltswahrscheinlichkeit. $\timestep =
        \num{1}$, $\margin = \num{0.632456}$, $\mu^2 = \num{1}$, $\timesites =
        \num{1000}$, $\iterations = \num{5000}$, $\bootstrapsamples = \num{1000}$.
    }
    \label{fig:histogram_10}
\end{figure}

\subsection{Korrelationen}

Die Energie des ersten angeregten Zustands kann mit der der Korrelation
berechnet werden \parencite[(4.14)]{Creutz/Statistical_Approach_QM}:
\begin{equation}
    \label{eq:Creutz_4.14}
    E_1 = \lim_{\tau \to \infty} \frac{-1}{\Deltaup \tau} \ln
    \del{\frac{\Bracket{x(0) \, x(\tau + \Deltaup \tau)}}{\Bracket{x(0) \,
    x(\tau)}}} + E_0.
\end{equation}

Dies ist äquivalent zu einer abfallenden Exponentialfunktion, die an die
Korrelationsfunktion $C_{11}(\tau) = \bracket{x(0) \, x(\tau)}$ angepasst wird.
Sei die Anpassungsfunktion
\[
    f(\tau) := c_1 \exp\del{-\frac{\tau}{c_2}}.
\]
Die Korrelationen in \eqref{eq:Creutz_4.14} drücke ich durch $f$ aus. Somit
erhalte ich:
\[
    E_1 - E_0
    = \lim_{\tau \to \infty} \frac{-1}{\Deltaup \tau} \ln
    \del{\frac{f(\tau + \Deltaup \tau)}{f(\tau)}}
    = \frac{1}{c_2}.
\]

In einem Simulationsdurchlauf mit $\timestep = \num{0.1}$, $\timesites =
\num{10000}$ und $\iterations = \num{10000}$ erhalte ich gute Korrelationen bis
$\tau \approx \num{7}$, siehe Abbildung~\ref{fig:84DAA2-correlation}. Aus der
Anpassung an diese Daten erhalte ich $1/c_2 = E_1 - E_0 = \num{0.995 +-
0.002}$. Dies passt gut mit der Erwartung von $\Deltaup E_{0,1} = \num{1}$
zusammen.

\begin{figure}[htbp]
    \centering
    \tikzsetnextfilename{84DAA2-correlation}
    \begin{tikzpicture}
        \begin{axis}[
                width=\linewidth,
                height=0.55\linewidth,
                xlabel={$\tau$},
                ylabel={$C_{11}(\tau)$},
                grid=major,
                legend entries={
                    {Simulation},
                    {Anpassung},
                },
            ]
            \addplot[
                black,
                only marks,
                mark=|,
                error bars/.cd,
                y dir=both,
                y explicit
            ] table[y error index=2] {_build/84DAA2-data.csv};
            \addplot[black] table {_build/84DAA2-fit.csv};
        \end{axis}
    \end{tikzpicture}
    \caption{%
        Korrelationsfunktion $C_{11}(\tau) = \bracket{x(0) \, x(\tau)}$ gegen
        imaginäre Zeit $\tau$. An die Punkte wurde eine abfallende
        Exponentialfunktion angepasst. Die Daten stammen aus einer Simulation
        mit $\timestep = \num{0.1}$, $\initialrandomwidth = \margin =
        \num{0.632456}$, $\mu^2 = \num{1}$, $\timesites = \num{10000}$,
        $\iterations = \num{10000}$ und $\bootstrapsamples = \num{1000}$.
    }
    \label{fig:84DAA2-correlation}
\end{figure}



\subsection{Energiewerte}

\section{Anharmonischer Oszillator}

Ab hier wird dem harmonischen Potential ein Gaußpotential überlagert. Je nach
Amplitude $\gaussheight$ und Breite $\gausswidth$ der Normalverteilung ergibt
sich ein anderes Potential. In Abbildung~\ref{fig:gausspotential} ist das
Gesamtpotential gezeigt.

\begin{figure}[htbp]
    \centering
    \tikzsetnextfilename{gausspotential}
    \begin{tikzpicture}
        \begin{axis}[
                width=\linewidth,
                height=0.55\linewidth,
                xlabel={$x$},
                ylabel={$V(x)$},
                grid=major,
            ]
            \addplot[black] table {CSV/FF7AA0-potential.csv};
        \end{axis}
    \end{tikzpicture}
    \caption{%
        Überlagerung von harmonischem Potential mit Gaußpotential. $\mu^2 =
        \num{1}$, $\gaussheight = \num{10}$, $\gausswidth = \num{1.0}$.
    }
    \label{fig:gausspotential}
\end{figure}

Mit dem veränderten Potential können alle vorherigen Rechnungen wiederholt
werden. Abbildung~\ref{fig:histogram_gauss} zeigt die
Aufenthaltswahrscheinlichkeit.

\begin{figure}[htbp]
    \centering
    \tikzsetnextfilename{histogram_gauss}
    \begin{tikzpicture}
        \begin{axis}[
                width=\linewidth,
                height=0.55\linewidth,
                xlabel={$x$},
                ylabel={$|\psi(x)|^2$},
                grid=major,
            ]
            \addplot[
                black,
                only marks,
                mark=|,
                error bars/.cd,
                y dir=both,
                y explicit
            ] table[y error index=2] {CSV/FF7AA0-histogram-position-resultset.csv};
        \end{axis}
    \end{tikzpicture}
    \caption{%
        Aufenthaltswahrscheinlichkeit. $\timestep = \num{0.1}$,
        $\initialrandomwidth = \num{0}$, $\margin = \num{0.632456}$, $\mu^2 =
        \num{1}$, $\timesites = \num{1000}$, $\iterations = \num{10000}$,
        $\bootstrapsamples = \num{1000}$, $\gaussheight = \num{10}$,
        $\gausswidth = \num{1.0}$.
    }
    \label{fig:histogram_gauss}
\end{figure}

% vim: ft=tex spell spelllang=de tw=79
